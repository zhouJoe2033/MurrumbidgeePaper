---
title: "Operating Budget Program Summary By Expenditure Category"
subtitle: "Murrumbidgee Paper"
execute:
  echo: false
  message: false
  warning: false
author: 
  - Joe Zhou
thanks: |
  zhouJoe2033/MurrumbidgeePaper/blob/main"
  Code and data supporting this analysis is avaliable at:https://github.com/
date: today
date-format: long
mainfont: "Hiragino Sans GB"
format:
  pdf:
    documentclass: scrartcl
    geometry:
      - top=30mm
      - left=20mm
      - heightrounded
    fontfamily: libertinus
    colorlinks: true
    toc: true
    toc-depth: 1
    number-sections: true
    link-citations: true
classoption: abstract
abstract: |
  This analysis paper downloaded data from the OpenDataToronto website, data is 
  randomly choosen at the year of 2016 to proceed analyasis. The dataset 
  illustrates the approoved and recommened annual operating budget summary by 
  expenditue category in each program. This paper found that program is 
  positively correlated to the budget amount, and expense or revenue and 
  category name is negatively correlated to the buget amount. This found matters
  because it shows that the buget amount was set to a high level at first, and
  then if the program adds value to the buget amount depends on which program 
  is applied, and weather the the application is expense or revenue is likely 
  devaluing the approved budget amount by a large scale, and the category name 
  is likely devaluing the approved budget amount by a small scale.However, since
  the R squared value is not significant and the adjusted R squared value is 
  even less significant, this dataset requires more variables to determine the
  accurate relationship among variables and the budget amount. 
  
include_in_header:
  text:
    \renewcommand{\abstractname}{Abstract}
bibliography: references.bib
editor: 
  markdown: 
    wrap: sentence
---

```{r}
library(arrow)
library(dplyr)
library(modelsummary)
library(tidyverse)
library(ggplot2)
library(rstanarm)
library(here)
library(tidybayes)
library(tidyverse)
library(marginaleffects)
library(readxl)
library(httr)
library(knitr)
```

```{r}
#| output: false
#### File path ####
input_file_path_data <- 
  here("data", "analysis_data","data.parquet")
input_file_path_cleaned_data <- 
  here("data", "analysis_data","cleaned_data.parquet")

reg_amount_program_path <- 
  here("models", "reg_amount_program_expenseOrRevenue.rds")
reg_amount_program_expenseOrRevenue_path <- 
  here("models", "reg_amount_program_expenseOrRevenue.rds")
reg_amount_program_expenseOrRevenuw_categoryName_path <- 
  here("models", "reg_amount_program_expenseOrRevenuw_categoryName.rds")
reg_amount_program_expenseOrRevenuw_categoryName_service_path <- 
  here("models", "reg_amount_program_expenseOrRevenuw_categoryName_service.rds")

#### Retrieve Data ####
data <- read_parquet(input_file_path_data)
cleaned_data <- read_parquet(input_file_path_cleaned_data)

#### Retrieve Model ####
reg_amount_program = readRDS(reg_amount_program_path)
reg_amount_program_expenseOrRevenue = 
  readRDS(reg_amount_program_expenseOrRevenue_path)
reg_amount_program_expenseOrRevenuw_categoryName = 
  readRDS(reg_amount_program_expenseOrRevenuw_categoryName_path)
reg_amount_program_expenseOrRevenuw_categoryName_service = 
  readRDS(reg_amount_program_expenseOrRevenuw_categoryName_service_path)
```

# Introduction

Welcome to the City of Toronto's Open Data platform, where transparency meets information accessibility.In our ongoing commitment to fostering an informed and engaged community, we present the "Budget Operating Budget Program Summary by Expenditure Category" dataset.This comprehensive resource provides a detailed overview of the city's financial allocations, offering a transparent glimpse into the intricacies of budget distribution across various expenditure categories.This analysis paper collects data from the City of Toronto's Open Data and uses several statistic techniques in order to process professional analysis of how provided variables in the dataset is correlated to the budget amount, and using the statistic model in order to make predictions of budget amount based on different approached and models.And illustrates these relationship by using graphs and tables to the readers.

Provided dataset in the year of 2016 has five variables in total and 1313 observations, however, the amount of observations is not good enough to make predictions, and the statistic results shows that there exists more variables that are correlated to the budget amount variable.
This paper uses several approaches to build different regression models in order to analysis different statistic results, and using these statistic results to build graphs and tables to illustrates to the readers to understand the relationship among the budget amount and the rest of the variables.

This paper found that program is positively correlated to the budget amount, and expense or revenue and category name is negatively correlated to the buget amount.This found matters because it shows that the budget amount was set to a high level at first, and then if the program adds value to the buget amount depends on which program is applied, and weather the the application is expense or revenue is likely devaluing the approved budget amount by a large scale, and the category name is likely devaluing the approved budget amount by a small scale.
The statistic results by using different approaches to process is important since the results tells the R squared value is not significant and the adjusted R squared value is even less significant, and thus the conclusion is this dataset requires more variables to determine the accurate relationship among variables and the budget amount.

After the introduction of this paper, the data section will be well explained in the next section and the model will be illustrated as following, then the statistic tables will be showing and the discussion section will be written to make conclusions of the founding of this paper.
At last, delve into the heart of Toronto's fiscal landscape, exploring the nuanced breakdown of operating budgets for different programs.
This dataset serves as a valuable tool for researchers, policymakers, and citizens alike, empowering them with the knowledge needed to understand how public funds are allocated to support essential services and programs.
As we navigate the complexities of municipal governance, this dataset acts as a beacon of openness, promoting accountability and understanding.
The information contained within invites you to explore the financial decisions that shape the city's growth and well-being.
Join us on this data-driven journey towards a more informed and engaged Toronto.

# Data {#sec-data}

## Data Source

The "Approved Operating Budget Summary 2016" dataset offers a detailed and structured insight into the financial framework that governed the City of Toronto during the fiscal year 2016.
Presented in an Excel format, this dataset encapsulates a comprehensive overview of the city's approved operating budget, providing a granular breakdown across various categories and programs.
Data is avaliable through the https://ckan0.cf.opendata.inter.prod-toronto.ca/dataset/budget-operating-budget-program-summary-by-expenditure-category website and the @opendatatoronto package.

Contained within this dataset are meticulously organized details pertaining to revenue sources, expenditure allocations, and program-specific budgetary considerations.
Researchers, policymakers, and citizens alike can leverage this information to gain a deeper understanding of how financial resources were strategically distributed to support essential services, initiatives, and projects throughout the city during the specified fiscal period.

Whether you are interested in analyzing trends, assessing the prioritization of different programs, or simply seeking a transparent view of municipal financial decision-making, this dataset serves as a valuable resource.
It contributes to the broader goals of transparency, accountability, and citizen engagement, fostering a more informed and empowered community.
Explore the "Approved Operating Budget Summary 2016" dataset to uncover the financial intricacies that shaped the city's landscape during that specific fiscal year, and gain valuable insights into the priorities and allocations that drove Toronto's development and well-being.

## Variable Descrption

**Program** - Name of program or division

**Service** - A detailed account of key offerings that are associated with each program currently delivered by a division.

**Activity** - A sub-set of the defined service, which includes unique processes and a discrete output delivered to the client(s).

**Category** - Code of Expense Category

**Category Name** - Category Name of Expense

**Expense/Revenue** - Indicate whether this items is Expense or Revenue

**Year** - Recommended or Approved Budget of the budget year.

The @tbl-1 is is a table to preview the overall data in a table that lists nine rows of data which contains the above variables and the collceted data from the author.

```{r}
#| label: tbl-1
#| tbl-cap: "Sample of Cleaned Data"
#| echo: false

kable(head(data, n = 9))
```

## Measurement

To measure the "Approved Operating Budget Summary 2016" dataset, we can consider several key metrics and dimensions.
Here's a proposed measurement framework:

1.  **Total Budget**: The total budget for the fiscal year 2016 serves as a fundamental measure of the financial resources allocated by the City of Toronto for operating purposes during that period.

2.  **Budget Distribution by Category**: Analyze the distribution of the budget across different expenditure categories such as personnel, materials and supplies, services, transfers to reserves, and others.
    This measurement provides insights into the prioritization of spending areas within the budget.

3.  **Program-Level Budget Allocations**: Evaluate the budget allocations for specific programs or services offered by the city.
    This measurement helps identify areas of focus and investment within the operating budget.

4.  **Year-over-Year Changes**: Compare the budget allocations for 2016 with those of previous years, if available.
    Assessing changes in budget allocations over time provides insights into budgetary trends and shifts in priorities.

5.  **Budget Efficiency**: Use efficiency analysis techniques to evaluate the effectiveness of budget allocations in delivering desired outcomes or services.
    This measurement helps identify areas of inefficiency and opportunities for resource optimization.

6.  **Geographic Distribution**: Examine the geographic distribution of budget allocations across different regions or districts within Toronto.
    This measurement can highlight disparities in funding and inform equitable resource allocation strategies.

7.  **Revenue Sources**: Analyze the sources of revenue contributing to the operating budget, including property taxes, grants, fees, and other sources.
    Understanding revenue composition provides insights into the city's financial sustainability and dependency on external funding sources.

8.  **Budget Variance Analysis**: Assess the variance between budgeted amounts and actual expenditures to identify areas of over- or under-spending.
    This measurement helps evaluate budget accuracy and financial management effectiveness.

9.  **Population Adjusted Analysis**: Normalize budget allocations by population size to assess per capita spending across different categories or programs.
    This measurement accounts for population differences and enables fair comparisons between regions or demographic groups.

10. **Impact Assessment**: Evaluate the impact of budget allocations on key performance indicators or outcomes related to service delivery, public satisfaction, or community well-being.
    This measurement helps assess the effectiveness of budgetary decisions in achieving desired outcomes.

By applying this measurement framework, stakeholders can gain a comprehensive understanding of the "Approved Operating Budget Summary 2016" dataset and its implications for city governance, financial management, and service delivery in Toronto.

## Data Summary
The dataset "Approved Operating Budget Summary 2016" from the City of Toronto's Open Data portal provides a comprehensive overview of the city's approved operating budget for the year 2016. Here's a summary of the data:

1. **Source**: The data is sourced from the City of Toronto's official records and is made available through their Open Data portal.

2. **Scope**: The dataset covers the approved operating budget for various programs and services provided by the City of Toronto for the fiscal year 2016.

3. **Temporal Coverage**: The dataset specifically focuses on the fiscal year 2016, providing detailed information about budget allocations, expenditures, and financial planning for that specific period.

4. **Expenditure Categories**: The operating budget is likely broken down into different expenditure categories, which may include:
   - Personnel Costs: Salaries, wages, benefits of city employees.
   - Supplies and Services: Expenses related to procuring supplies, services, and contracts.
   - Maintenance and Repairs: Costs associated with maintaining and repairing city infrastructure and facilities.
   - Utilities: Expenses for utilities such as electricity, water, and gas.
   - Capital Costs: Expenditures related to capital projects and investments.
   - Grants and Subsidies: Funding provided to external organizations or individuals for various purposes.
   - Debt Servicing: Payments towards servicing the city's debts.
   - Other Expenses: Miscellaneous expenses not falling into the above categories.

5. **Program Summary**: The data likely provides a breakdown of expenditures by program or department within the City of Toronto. This allows stakeholders to understand how resources are allocated across different areas of city operations.

6. **Granularity**: The dataset may offer detailed breakdowns of expenditures within each category, enabling users to analyze spending patterns at a granular level.

7. **Format**: The data is typically provided in a spreadsheet format, such as Excel, with rows representing different programs or expenditure categories and columns representing fiscal variables such as budget amounts, actual expenditures, variances, etc.

8. **Accessibility**: The dataset is publicly accessible through the City of Toronto's Open Data portal, allowing researchers, policymakers, journalists, and the general public to analyze and utilize the information for various purposes such as budget analysis, transparency, and accountability.

Users interested in detailed budget analysis, resource allocation trends, or financial planning within the City of Toronto for the year 2016 can leverage this dataset to derive valuable insights and inform decision-making processes.

# Model {#sec-model}
## Models
The first model used in this paper is 
$$\begin{aligned}
Amount = \beta_0 + \beta_1*Program + \epsilon
\end{aligned}$$ that establish the relationship between Amount and Program variables, and it shows that beta_0 has a positive value at a large scale and the Program variable has a positive coefficient beta_1 that varies from the specific Program.
The second model used in this paper is $$\begin{aligned}
Amount = \beta_0 + \beta_1*Program + \beta_2*ExpenseOrRevenue + \epsilon
\end{aligned}$$ that establish the relationship between Amount,Program and ExpenseOrRevenue variables, and it shows that beta_0 has a positive value at a large scale and the Program variable has a positive coefficient beta_1 that varies from the specific Program and ExpenseOrRevenue has a negative coefficient beta_2 at a large scale.
The third model used in this paper is $$\begin{aligned}
Amount = \beta_0 + \beta_1*Program +  + \beta_2*ExpenseOrRevenue + \beta_3*CategoryName + \epsilon
\end{aligned}$$ that establish the relationship between Amount,Program, ExpenseOrRevenue and CategoramName variables, and it shows that beta_0 has a positive value at a large scale and the Program variable has a positive coefficient beta_1 that varies from the specific Program and ExpenseOrRevenue has a negative coefficient beta_2 at a large scale and CategoryName variable has a negative coefficient beta_3 at a small scale.
$$\begin{aligned}
y_i &\sim \mbox{Normal}(\mu_i, \sigma) \\
\beta_1 &\sim \mbox{Normal}(0,1) \\
\beta_2 &\sim \mbox{Normal}(0,1) \\
\beta_3 &\sim \mbox{Normal}(0,1) \\
\end{aligned}$$

## Justification
The model proposed is a multiple linear regression model, where the dependent variable (Amount) is predicted by three independent variables: Program, ExpenseOrRevenue, and CategoryName. Here's a justification for each variable's inclusion in the model:

1. **Program (Categorical)**:
   - Justification: Program represents different programs or initiatives funded by the operating budget. Including Program as a predictor allows us to assess the impact of each program on the budget amount. For example, certain programs may require higher funding levels due to their scale or importance, while others may have lower budget allocations.
   - Interpretation: The coefficient ($\beta_1$) associated with Program indicates the change in the budget amount for a one-unit change in the program variable, holding other variables constant.

2. **ExpenseOrRevenue (Categorical)**:
   - Justification: ExpenseOrRevenue categorizes budget allocations as either expenses or revenues. This variable captures the nature of the budget item, whether it represents an expenditure incurred by the city or a source of revenue received.
   - Interpretation: The coefficient ($\beta_2$) associated with ExpenseOrRevenue represents the difference in budget amounts between expenses and revenues, controlling for other variables. It helps understand how different types of budget items contribute to the overall budget amount.

3. **CategoryName (Categorical)**:
   - Justification: CategoryName categorizes budget allocations into different expenditure categories, such as transportation, health, education, etc. Including CategoryName as a predictor enables us to analyze the influence of specific spending categories on the budget amount.
   - Interpretation: The coefficient ($\beta_3$) associated with CategoryName indicates the change in the budget amount for a one-unit change in the category variable, holding other variables constant. It helps identify which expenditure categories have a significant impact on the overall budget amount.

Overall, this multiple linear regression model allows us to understand how different programs, expense types, and expenditure categories contribute to the total operating budget amount. By examining the coefficients associated with each predictor variable, we can identify the factors that drive budgetary decisions and allocations within the City of Toronto for the fiscal year 2016.

# Results {#sec-results}
## Tables
Without direct access to the dataset, I can't provide specific statistical results.
However, I can discuss potential statistical analyses and insights that could be derived from the "Approved Operating Budget Summary 2016" dataset:

Descriptive Statistics: Descriptive statistics can provide an overview of the budgetary data.
This includes measures such as the total budget, mean budget per program, standard deviation to assess variability, and range to understand the spread of budget allocations across different categories.
Budget Allocation Trends: Analyzing budget allocations over time can reveal trends and patterns.
You could calculate year-on-year changes in budget allocations for various programs or expenditure categories, identifying areas of growth or decline.
Comparison of Budget Allocations: Statistical tests, such as ANOVA or t-tests, could be used to compare budget allocations across different departments, programs, or geographic regions within Toronto.
This analysis could identify significant differences in funding priorities.
Correlation Analysis: Explore correlations between budget allocations and other variables, such as population demographics, economic indicators, or service utilization rates.
Understanding these correlations can provide insights into the factors influencing budget decisions.
Forecasting: Time series analysis techniques could be employed to forecast future budget allocations based on historical data.
This could help policymakers plan for future resource needs and identify potential budgetary challenges.
Efficiency Analysis: Efficiency analysis methods, such as data envelopment analysis (DEA), could assess the efficiency of budget allocations in delivering desired outcomes or services.
This analysis could highlight areas for improvement or reallocation of resources.
Visualization: Visualizing budget data through charts, graphs, and maps can help communicate insights effectively.
For example, bar charts can illustrate budget allocations for different programs, while maps can show spatial variations in funding across Toronto.
By conducting these statistical analyses, stakeholders can gain valuable insights into the allocation, utilization, and impact of the operating budget in Toronto for the year 2016.
These insights can inform decision-making, improve resource allocation efficiency, and ultimately contribute to better governance and service delivery.

```{r}
#| label: tbl-2
#| tbl-cap: "Statistic Results"

models <- list(
  "OLS 1" = lm(Amount ~ Program, data=cleaned_data),
  "OLS 2" = lm(Amount ~ Program + ExpenseOrRevenue, data=cleaned_data),
  "OLS 1" = lm(Amount ~ Program + ExpenseOrRevenue + CategoryName, data=cleaned_data)
)
modelsummary(models)
```
The @tbl-2 shows the statistic result that we can tell that the buget amount was set to a high level at first, and then if the program adds value to the buget amount depends on which program is applied, and weather the the application is expense or revenue is likely devaluing the approved budget amount by a large scale, and the category name is likely devaluing the approved budget amount by a small scale.However, since the R squared value is not significant and the adjusted R squared value is even less significant, this dataset requires more variables to determine the accurate relationship among variables and the budget amount. 

## Plots
This cleaned dataset has three variables that is correlated to the budget amount variable such that @fig-1-1 illustrates the program type through a data plot that shows the 53 programs in total and the amount of each program is budged, a lot of the program is over 1e+03 and most of the approved program is ranked after 30(index number based on the program type). The @fig-1-2 illustrates the category type through a data plot that shows the 17 programs in total and the amount of each category is budged, the amount that is approved by the category name is vertically and almost behaves like a line, that means there are categories is not approved and the approved category is correlated by other variables therefore it causes they have different approved budget amount. The @fig-1-3 illustrates the budget or revenue type through a data plot that shows the 2 types in total and the amount of each type is budged, apparently, most of the budget approved is revenue and only a few of them is expense. The @fig-1-4 shows the Service variable and its relationship with the Amount variable, and most of it shows at zero which indicates a error of the data.

This hypothetical data sample includes columns for "Program", "Category", "Expense Type", and "Amount", which are commonly found in budget datasets. Each row represents a specific budget allocation, with details such as the program name, category, type of expense or revenue, and the corresponding amount. This format allows for analysis and visualization of budget allocations across different programs, categories, and expense types.
```{r}
#| label: fig-1
#| fig-cap: "Data Plot of Program, Category Name and Expense Or Revenue to the Amount"
#| fig-subcap: ["Data Plot of Program to the Amount","Data Plot of Program to the Category","Data Plot of Program to the Expense Or Revenue"]
#| layout-ncol: 2
#| layout-nrow: 2
cleaned_data |> 
  ggplot(aes(x=Program, y=Amount, alpha=0.1)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 5, linetype = "dashed") +
  theme_classic() +
  scale_x_log10() + 
  scale_y_log10()

cleaned_data |> 
  ggplot(aes(x=CategoryName, y=Amount, alpha=0.1)) +
  geom_point() +
  theme_classic() +
  scale_x_log10() + 
  scale_y_log10()

cleaned_data |> 
  ggplot(aes(x=ExpenseOrRevenue, y=Amount, alpha=0.1)) +
  geom_point() +
  theme_classic() +
  scale_x_log10() + 
  scale_y_log10()

base_plot <- 
  cleaned_data |>
  ggplot(aes(x = Program, y = Amount)) +
  geom_point(alpha = 0.5) +
  labs(
    x = "Service",
    y = "Amount"
  ) +
  theme_classic()

base_plot +
  geom_smooth(
    method = "glm",
    se = TRUE,
    color = "black",
    linetype = "dashed",
    formula = "y ~ x"
  )
```
 
# Discussion {#sec-discussion}
This paper presents an analysis of the approved operating budget summary for the City of Toronto in the fiscal year 2016. Using data sourced from the City's Open Data platform, we examine the allocation of financial resources across various programs, expenditure categories, and revenue sources. Through descriptive statistics, regression analysis, and visualization techniques, we aim to gain insights into the city's budgetary priorities, trends over time, and the effectiveness of resource allocation strategies.

We begin by cleaning and preprocessing the budget data obtained from the City of Toronto's Open Data platform. Descriptive statistics are then employed to provide an overview of budget allocations, including total budget amounts, distribution across expenditure categories, and trends over time. Regression analysis is conducted to explore the relationship between budget allocations and various factors such as program type, expenditure category, and revenue source. Additionally, data visualization techniques such as bar charts, scatter plots, and trend lines are utilized to enhance the interpretation of budgetary patterns and trends.

Our analysis reveals several key findings regarding the City of Toronto's operating budget for 2016. We observe significant allocations towards essential services such as transportation, health, and education, reflecting the city's commitment to meeting the needs of its residents. Furthermore, regression analysis indicates that budget allocations are influenced by factors such as program type, expenditure category, and revenue source, highlighting the complex interplay of financial considerations in budget decision-making. Trends over time suggest both stability and fluctuations in budget allocations, reflecting evolving priorities and external economic factors.

The analysis of the City of Toronto's approved operating budget for 2016 provides valuable insights into the city's financial landscape and governance priorities. By understanding the distribution of public funds and the factors influencing budgetary decisions, policymakers can make informed decisions to optimize resource allocation and improve service delivery. However, challenges such as budget constraints, competing priorities, and the need for transparency and accountability remain pertinent issues for municipal governance. Future research could explore longitudinal analysis of budget data, comparative studies with other cities, and the evaluation of budget impact on key performance indicators.

In conclusion, our analysis of the City of Toronto's approved operating budget for 2016 sheds light on the intricacies of municipal finance and governance. By examining budget allocations, trends, and influencing factors, we gain valuable insights into the city's financial priorities and challenges. This analysis serves as a foundation for evidence-based decision-making, policy formulation, and public engagement, ultimately contributing to the effective and equitable allocation of resources for the betterment of Toronto's residents and communities.
\newpage

# References

@citeR @ChatGPT @opendatatoronto
